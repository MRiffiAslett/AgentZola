[paths]
prompt_dir = "prompts"
output_dir = "generated-outputs"
hf_home = "hf_cache"
log_file = "whitefox-llm-gen.log"
bandit_state_file = "whitefox_state.json"

[model]
name = "bigcode/starcoder"
dtype = "float16"
max_model_len = 8192
gpu_memory_utilization = 0.85
swap_space = 4

[generation]
num_samples = 1     
max_tokens = 4096   
temperature = 1.0    
top_p = 1.0        
split_size = 20      
unit_num = 2       

optimizations_dir = "xilo_xla/artifacts/generation-prompts" 
tests_per_optimization = 10  
tests_per_iteration = 5      
max_iterations = 15         
examples_per_prompt = 3       
test_timeout = 30             
parallel_test_workers = 4   
parallel_optimizations = 2     

optimizations = [
    "AllGatherBroadcastReorder",
    "AllGatherCombiner",
    "AllGatherDecomposer",
    "AllReduceCombiner",
    "AllReduceFolder",
    "AllReduceReassociate",
    "AllReduceSimplifier",
    "AsyncCollectiveCreator",
    "BatchDotSimplification",
    "Bfloat16ConversionFolding",
    "BroadcastCanonicalizer",
    "ChangeOpDataType",
    "CollectivesScheduleLinearizer",
    "ConcatForwarding",
    "ConditionalCanonicalizer",
    "ConvertAsyncCollectivesToSync",
    "ConvertMover",
    "Defuser",
    "DotDecomposer",
    "DotMerger",
    "DynamicIndexSplitter",
    "HloConstantFolding",
    "HloCse",
    "HloDce",
    "HloElementTypeConverter",
    "IdentityConvertRemoving",
    "IdentityReshapeRemoving",
    "LoopScheduleLinearizer",
    "MapInliner",
    "ReduceScatterCombiner",
    "ReduceScatterDecomposer",
    "ReduceScatterReassociate",
    "ReshapeBroadcastForwarding",
    "ReshapeReshapeForwarding",
    "ShardingRemover",
    "SimplifyFpConversions",
    "SliceConcatForwarding",
    "SliceSinker",
    "SortSimplifier",
    "StochasticConvertDecomposer",
    "TopkRewriter",
    "TransposeFolding",
    "TreeReductionRewriter",
    "TupleSimplifier",
    "WhileLoopConstantSinking",
    "WhileLoopExpensiveInvariantCodeMotion",
    "WhileLoopInvariantCodeMotion",
    "WhileLoopTripCountAnnotator",
    "ZeroSizedHloElimination",
]


[stopping]
eof_strings = [
    "<|endoftext|>",
    "###",
    "__output__ =",
    "if __name__",
    '"""',
    "'''",
    "# Model ends",
    "# LLVM IR ends",
    "# C++ Code ends",
]

[oracles]
float_rtol = 1e-5  # Relative tolerance for float comparison
float_atol = 1e-8  # Absolute tolerance for float comparison

[pass_name_aliases]
AllGatherBroadcastReorder = ["all-gather-bcast-reorder"]
AllGatherCombiner = ["all-gather-combiner", "gpu-all-gather-combiner"]
AllGatherDecomposer = ["all_gather_decomposer"]
AllReduceCombiner = ["all-reduce-combiner", "gpu-all-reduce-combiner"]
AllReduceFolder = ["all-reduce-folder"]
AllReduceReassociate = ["all-reduce-reassociate"]
AllReduceSimplifier = ["all-reduce-simplifier"]
AsyncCollectiveCreator = ["async-collective-creator"]
BatchDotSimplification = ["batch-dot-simplification"]
Bfloat16ConversionFolding = ["bfloat16-fold"] 
BroadcastCanonicalizer = ["broadcast_canonicalizer"]
ChangeOpDataType = ["change-op-data-type"]
CollectivesScheduleLinearizer = ["collectives-schedule-linearizer"]
ConditionalCanonicalizer = ["conditional-canonicalizer"]
ConvertAsyncCollectivesToSync = ["convert-async-collectives-to-sync"]
ConvertMover = ["convert-mover"]
Defuser = ["defuser"]
DotDecomposer = ["dot_decomposer"]
DotMerger = ["dot-merger"]
DynamicIndexSplitter = ["dynamic-index-splitter"]
HloConstantFolding = ["constant_folding"]
HloCse = ["cse"]
HloDce = ["dce"]
HloElementTypeConverter = ["element_type_converter"]
LoopScheduleLinearizer = ["loop-schedule-linearizer"]
MapInliner = ["map-inline"]
ReduceScatterCombiner = ["reduce-scatter-combiner", "gpu-reduce-scatter-combiner"]
ReduceScatterDecomposer = ["reduce-scatter-decomposer"]
ReduceScatterReassociate = ["reduce-scatter-reassociate"]
ShardingRemover = ["sharding-remover"]
SimplifyFpConversions = ["simplify-fp-conversions"]
SliceSinker = ["slice-sinker"]
SortSimplifier = ["simplify-sorts"]
StochasticConvertDecomposer = ["stochastic_convert_decomposer"]
TopkRewriter = ["topk-rewriter"]
TransposeFolding = ["transpose-folding"]
TreeReductionRewriter = ["tree_reduction_rewriter", "tree-reduction-rewriter"]
TupleSimplifier = ["tuple-simplifier"]
WhileLoopConstantSinking = ["while-loop-constant-sinking"]
WhileLoopExpensiveInvariantCodeMotion = ["while-loop-expensive-invariant-code-motion"]
WhileLoopInvariantCodeMotion = ["while-loop-invariant-code-motion"]
WhileLoopTripCountAnnotator = ["while-loop-trip-count-annotator"]
ZeroSizedHloElimination = ["zero_sized_hlo_elimination"]

ConcatForwarding = ["concat-forwarding"]
IdentityConvertRemoving = ["identity-convert-removing"]
IdentityReshapeRemoving = ["identity-reshape-removing"]
ReshapeBroadcastForwarding = ["reshape-broadcast-forwarding"]
ReshapeReshapeForwarding = ["reshape-reshape-forwarding"]
SliceConcatForwarding = ["slice-concat-forwarding"]

