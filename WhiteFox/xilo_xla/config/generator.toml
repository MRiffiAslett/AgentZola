# StarCoder Generation Configuration
# Configuration for generating test programs using VLLM

[paths]
prompt_dir = "prompts"
output_dir = "generated-outputs"
hf_home = "hf_cache"
log_file = "whitefox-llm-gen.log"
# WhiteFox-specific paths
bandit_state_file = "whitefox_state.json"



[model]
name = "bigcode/starcoder"
dtype = "float16"
max_model_len = 8192
gpu_memory_utilization = 0.95
swap_space = 20

[generation]
num_samples = 1     # Total number of output samples to generate per prompt
max_tokens = 4096    # Maximum number of tokens to generate for each output
temperature = 1.0    # Controls randomness (higher = more random)
top_p = 1.0          # Nucleus sampling limit (1.0 = consider all tokens)
split_size = 20      # Number of prompts processed together per batch
unit_num = 2        # Number of samples generated per batch call (until num_samples reached)
# WhiteFox-specific generation parameters
optimizations_dir = "xilo_xla/artifacts/Prompts/test"  # Path to requirement prompt directory
tests_per_optimization = 10  # Total tests to generate per optimization
tests_per_iteration = 10      # Tests to generate per iteration (10 tests per batch as per spec)
max_iterations = 20           # Maximum iterations per optimization
examples_per_prompt = 3        # Number of examples to include in feedback prompt (few-shot)

# Hardcoded list of optimizations that WhiteFox targets
optimizations = [
    "AllGatherBroadcastReorder",
    "AllGatherCombiner",
    "AllGatherDecomposer",
    "AllReduceCombiner",
    "AllReduceFolder",
    "AllReduceReassociate",
    "AllReduceSimplifier",
    "AsyncCollectiveCreator",
    "BatchDotSimplification",
    "Bfloat16ConversionFolding",
    "BroadcastCanonicalizer",
    "ChangeOpDataType",
    "CollectivesScheduleLinearizer",
    "ConcatForwarding",
    "ConditionalCanonicalizer",
    "ConvertAsyncCollectivesToSync",
    "ConvertMover",
    "Defuser",
    "DotDecomposer",
    "DotMerger",
    "DynamicIndexSplitter",
    "HloConstantFolding",
    "HloCse",
    "HloDce",
    "HloElementTypeConverter",
    "IdentityConvertRemoving",
    "IdentityReshapeRemoving",
    "LoopScheduleLinearizer",
    "MapInliner",
    "ReduceScatterCombiner",
    "ReduceScatterDecomposer",
    "ReduceScatterReassociate",
    "ReshapeBroadcastForwarding",
    "ReshapeReshapeForwarding",
    "ShardingRemover",
    "SimplifyFpConversions",
    "SliceConcatForwarding",
    "SliceSinker",
    "SortSimplifier",
    "StochasticConvertDecomposer",
    "TopkRewriter",
    "TransposeFolding",
    "TreeReductionRewriter",
    "TupleSimplifier",
    "WhileLoopConstantSinking",
    "WhileLoopExpensiveInvariantCodeMotion",
    "WhileLoopInvariantCodeMotion",
    "WhileLoopTripCountAnnotator",
    "ZeroSizedHloElimination",
]


[stopping]
eof_strings = [
    "<|endoftext|>",
    "###",
    "__output__ =",
    "if __name__",
    '"""',
    "'''",
    "# Model ends",
    "# LLVM IR ends",
    "# C++ Code ends",
]

[oracles]
float_rtol = 1e-5  # Relative tolerance for float comparison
float_atol = 1e-8  # Absolute tolerance for float comparison

